# <center>iot-mgt系统设计文档</center>
## 项目说明
IOT系统前端项目，此项目采用前后端分离的开发模式，基础框架是采用MVVM框架进行开发，目前系统功能满足华星光电的需求。

## 技术栈
vue+vue-router+vuex+echarts+webpack

## 项目部署
使用webpack进行项目构建，运行开发环境和打包工作。生产环境通过nginx进行部署，同时进行反向代理处理跨域的问题。

## 选型说明
vue
vue是目前市场上非常成熟的MVVM开发框架，并且有自己完善的生态圈，开发使用方便，维护简单。框架维护团队大，后期技术更新迭代有保证。

## Iview
基于vue的第三方UI库，组建丰富，满足目前管理系统的所有常用组建。可以使用less变量对UI进行快速修改

## echarts
百度开源的图表组件，图表类型丰富，接口简单，便于使用，可以满足目前市面上的各类图形要求，基于现在的需求能完全满足，且后期有需求拓展也能满足。

## smartBi
付费报表工具，工具的功能和使用能满足用户的要求

## mxGraph
工业级别的流程图，例如draw.io等都是基于mxGraph二次开发的。源码开放，满足目前需求中的部分绘图功能，基于其二次开发成本较于自己开发低。

## 架构图
IOT前端系统架构图如下：
[processon地址](!https://www.processon.com/view/link/5c74faa1e4b0c4e216621bf5)

## 架构说明
### 开发模式
此项目采用前后端分离的模式进行开发，以vue为基础框架进行开发，路由、状态均使用vue的生态系统vue-router和vuex

### 业务模块
#### 权限管理
登陆
登陆前端将密码以md5的形式加密，上报给后台，后台返回token来验证用户是否登陆，同时返回该用户的操作权限列表。由于存在双域名（iot.csot.tcl.com、iotmgt.csot.tcl.com），因此浏览器存储要求使用cookie，domain设置为一级域名
菜单权限
后端接口返回动态生成
功能权限
通过自定义指令，在insert时根据后端返回的是否有权限动态销毁DOM节点
数据权限
请求头通过Authorization字段携带token进行验证，由后端处理数据权限
设备管理
设备管理模块功能用于设备、网关的基础操作，同时对设备进行对应数据进行展示，主要使用Iview内的树、时间选择器、表格，数据使用echarts进行图表展示

#### 资产管理
资产管理模块用于将设备、网关挂载到资产，资产再归属于部门，便于管理设备和部门之间的关系。主要使用Iview内的树、时间选择器、表格，数据使用echarts进行图表展示，其中涉及多级联动。

#### 系统管理
系统管理数据主要来源与华星OA系统同步的数据，主要对数据进行结构性的展示，以及对用户、部门进行角色的划分和授权。

#### 数据字典
数据字典模块主要是对系统中的一些参数型字段进行配置，避免代码内固定，增加维护成本。技术上集中在表格、浮窗等的操作。

#### 应用中心
应用中心通过将界面工具生成的界面组合成应用，减少客制化开发监控应用的成本。应用中心的难度集中体现在：

动态生成多页面（动态路由的使用），并在vue内存在路由关系，可以在其生命周期的控制范围内
数据的绑定，需要将xml格式的文件解析出来并进行数据交互操作
根据配置信息，集成smartBi的报表页面
### 工具模块
工具主要分为报表工具（smartBi）和界面生成工具，两个工具分单独运行，通过链接的方式在本系统内展示。smartBi是第三方成熟系统，界面工具是基于mxGraph二次开发的工具，详细设计文档可以参考界面工具前端设计文档

#### 逻辑层
逻辑层主要实现功能，以及在开发过程中使用的技术栈，以及开发所支持的框架和语法。

## 前端工程化
选择的是webpack作为构建工具，配置babel、tslint等编译规范，解决在开发过程中遇到浏览器兼容、跨域等问题。

## 应用开源
我们所有package.json内dependencies的库均来自于npm内，通过使用package-lock.json固定对应版本，避免版本混乱。开发过程中通过使用npm安装，即可使用对应的插件、库。

## 运行环境
根据用户要求，本系统向下兼容个至IE11.0.9600.19036

